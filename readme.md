# Environment for assessing tests on personalization

## Overview

Personalization is a trend in website development for quite a while now with websites moving from segmentation to personalization of content for individual users. At present personalization is already a [vital element](https://www.forbes.com/sites/blakemorgan/2020/02/18/50-stats-showing-the-power-of-personalization/?sh=67819f892a94) in the strategy of digital businesses with about [89%](https://go.forrester.com/blogs/transform-your-personalization-strategy-at-forresters-consumer-marking-forum/) of them investing in it and even [51%](https://smarterhq.com/blog/b2c-marketing-report) of marketeers ranking it as their top priority! Following this trend, many researchers have conducted studies [[1]](https://dl.acm.org/doi/pdf/10.1145/2488388.2488435) [[2]](https://core.ac.uk/download/pdf/301380834.pdf) [[3]](https://dl.acm.org/doi/pdf/10.1145/3308558.3313682) to gain more information about personalization and its impact on users. In several of these studies, researchers used self-developed software to determine if or to what degree certain contents are being personalized. 

These testing programs deliver results on different websites, but the major drawback in this procedure is, that these programs cannot be tested well. Therefore the validity of the different program's results may be slightly limited.

To resolve this issue, this testing environment provides the user with different content configurations to make a website static, dynamic or personalized. This allows to apply the developed testing programs on websites, generated by the environment, with known configurations to evaluate the results by comparing them to the expected outcome based on the configurations. 

Furthermore, this environment allows to benchmark different tests or approaches by using a predefined set of configurations. This may be useful before conducting large scale studies to assess the efficiency of different tests or approaches. Additionally, this also enables the possibility of test-driven development of such tests before applying them to real-world targets/websites.



## How to start 

### Setting up the environment

Before using the environment the following steps need to be carried out:

1. install packages of the ```requirements.txt```
2. run ```create_db.py``` and ```fill_db.py```

Disclaimer!: This Test is a prototype which is meant to run locally. The Database implementation is not Secure!
Also be aware that after resetting the DB, the already existing browser cookies must also be deleted from the web storage


### Starting the Environment

To start the website run the ```webpage.py``` script of this project.

The environment and the test, which is to be performed are independent of each other. The URL of the website is generally the only interface between the environment and the test. Configuration of the environment is done via the URL. The following URL for example results in a webpage with a personalized structure and a dynamic color:

```http://127.0.0.1:5000/ecommerce/struct=p&color=d```

Generally, the URL consists of three main parts:

```http://<localhost and Port>/<website type>/<configurations>```


### Localhost and Ports
To access the webpage, you need to know where the Flask application is running on. This information is printed out directly after running the ```webpage.py``` to start the Flask Application. By default, Flask is running on the localhost with port 5000.

### Website Type
The second part of the URL indicates which of the following webpages of the environment to use:

```home```  A non-configurable homepage with the general information about this Project

```ecommerce``` Webpage of an e-commerce retailer that can be configured for testing


### Configurations
The last part of the URL is the configuration, which can be added for the configurable website types. By default everything element is set to be static.

Configurations are consisting of a key and a value. The key references one element of the website and the value specifies which state the content shall have. In the following the possible key-value-pairs are listed:



| Element      | Key      | Value    |
| --------     | -------- | -------- | 
|Structure of the Page| struct      | s,d,p    |
|Color-scheme (light vs Dark)| color       | s,d,p,dark,light,time    |
|Number of columns (structure)| cols     | s,d,p,number (of columns )  | 
|Page Header| header   | f,s,d,p, headertext    |
|Already used User| user     | number (user id) |
|Target Group| tg       | number (id of a target group) |
|Price | price    | s,d,p |
|Content| content| s,d,p|
|Product tags| tag | s,d,p|
|User location|location| s,d,p|
|Default value for all above Elements except user and target group| default | s,d,p|

User Recognition Configurations:

By default recognition is based on cookies and the recognition by browser finerprint and ip is turned off (recognition by ip has not been tested)

| Element      | Key      | Value    |
| --------     | -------- | -------- | 
|Recognition by Cookies| cookie      | t,f  |
|Recognition by Browser Fingerprint| bfp       | t ,f  |
|Recognition by IP| ip    | t,f | 
|Making all users new users  | newuser   | t,f|

Values:


| Value | Explanation | 
| -------- | -------- |
| s         | Static Element     | 
| d | dynamic (randomized) element |
| p | personalized element|
| t | True |
| f | False |
|number | integer (meaning dependend on key) |
|dark| dark color-scheme|
|light|light color-scheme|
|time| time depending color-scheme (nightmode)|
|headertext| Text that the Header shall display. Spaces should be replaced in the URL by ```-```. They will be turned to spaces by the programm again|

In the configurations section of the URL there might then be multiple key-value pairs in the following format:

```<key>=<value>```

with multiple pairs separated by an ```&```:

```<key>=<value>&<key>=<value>&<key>=<value>....```

An exemplary URL could then look the following:

```http://127.0.0.1:5000/ecommerce/struct=p&color=d&color=time&cols=3&header=this-is-a-header-text&location=s```

For all keys that are not specified in the URL, the state is either as configured by the default configuration or if the default is not configured they are static.



## Advanced Configurations

To simulate personalization every user gets a "target group" that determines how the elements are displayed when they shall be personalized. When applying tests that use requests for personalization and do not open the webpage in a browser, it might be of interest to send the user to the server. Therefore it is possible to configure the user as well.

Furthermore, it is possible to specify for a request a target group so that it is possible to simulate changing personalization. Additionally, the number of target groups can be set. This allows to simulate personalization based on segmentation (small number of target groups) as well as individual personalization (large number of target groups). By default, the number of target groups is set to 10.


| Element      | Key      | Value    | 
| -------- | -------- |--------|
|Already used User| user     | number (user id) |
|Target Group| tg       | number (id of a target group) |
|target group count| ntg | number (of target groups)|







